<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†Œë°©ì‹œì„¤ ê²€ìƒ‰ ì‹œìŠ¤í…œ</title>
    <style>
        /* ê¸°ë³¸ ë¦¬ì…‹ ë° í°íŠ¸ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f5f5f5;
            color: #333333;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size: 16px;
            line-height: 1.6;
        }

        /* ì „ì²´ ë ˆì´ì•„ì›ƒ */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 24px 16px;
        }

        /* í—¤ë” */
        header {
            text-align: center;
            margin-bottom: 32px;
        }

        header h1 {
            font-size: 24px;
            font-weight: 700;
            color: #f44336;
            margin-bottom: 8px;
        }

        header p {
            font-size: 14px;
            color: #666;
        }

        /* ì¹´ë“œ ê³µí†µ */
        .card {
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 24px;
        }

        /* ê²€ìƒ‰ ì„¹ì…˜ */
        .search-section .search-row {
            display: flex;
            gap: 8px;
        }

        .search-section label {
            display: block;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        .search-section input[type="text"] {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.2s;
        }

        .search-section input[type="text"]:focus {
            border-color: #2196F3;
        }

        .search-section button {
            padding: 10px 20px;
            background-color: #2196F3;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.2s;
        }

        .search-section button:hover {
            background-color: #1976D2;
        }

        /* ìƒ˜í”Œ ì£¼ì†Œ íŒíŠ¸ */
        .hints {
            margin-top: 12px;
            font-size: 14px;
            color: #666;
        }

        .hints span {
            display: inline-block;
            margin: 4px 6px 4px 0;
            background: #e3f2fd;
            color: #1565c0;
            padding: 2px 10px;
            border-radius: 12px;
            cursor: pointer;
        }

        .hints span:hover {
            background: #bbdefb;
        }

        /* ë¡œë”© ë©”ì‹œì§€ */
        #loading {
            text-align: center;
            color: #2196F3;
            padding: 12px 0;
            display: none;
        }

        /* ì˜¤ë¥˜ ë©”ì‹œì§€ */
        #error-msg {
            color: #f44336;
            background: #ffebee;
            border-radius: 4px;
            padding: 12px 16px;
            margin-bottom: 24px;
            display: none;
        }

        /* ê²°ê³¼ ì„¹ì…˜ */
        #result-section {
            display: none;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #333;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 8px;
        }

        /* ê±´ì¶•ë¬¼ ì •ë³´ ê·¸ë¦¬ë“œ */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .info-item {
            background: #f9f9f9;
            border-radius: 4px;
            padding: 10px 14px;
        }

        .info-item .label {
            font-size: 12px;
            color: #888;
            margin-bottom: 4px;
        }

        .info-item .value {
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        /* íŒë‹¨ ê²°ê³¼ */
        .result-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 20px;
            font-weight: 700;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .result-badge.target {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .result-badge.non-target {
            background: #f5f5f5;
            color: #757575;
        }

        /* ë²•ë ¹ ìƒì„¸ */
        .law-detail {
            background: #f5f5f5;
            border-radius: 4px;
            padding: 14px 16px;
            font-size: 14px;
        }

        .law-detail p {
            margin-bottom: 8px;
        }

        .law-detail p:last-child {
            margin-bottom: 0;
        }

        .law-detail .law-label {
            color: #888;
            font-size: 12px;
        }

        .law-detail .law-value {
            color: #333;
            font-weight: 500;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 520px) {
            .info-grid {
                grid-template-columns: 1fr;
            }

            .search-section .search-row {
                flex-direction: column;
            }

            .search-section button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- í—¤ë” -->
    <header>
        <h1>ğŸ”¥ ì†Œë°©ì‹œì„¤ ê²€ìƒ‰ ì‹œìŠ¤í…œ</h1>
        <p>ì˜¥ë‚´ì†Œí™”ì „ ì„¤ì¹˜ ëŒ€ìƒ ì¡°íšŒ (í”„ë¡œí† íƒ€ì…)</p>
    </header>

    <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
    <section class="card search-section">
        <label for="address-input">ğŸ  ê±´ì¶•ë¬¼ ì£¼ì†Œ ì…ë ¥</label>
        <div class="search-row">
            <input
                type="text"
                id="address-input"
                placeholder="ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 152"
                autocomplete="off"
            />
            <button id="search-btn" onclick="searchBuilding()">ê²€ìƒ‰</button>
        </div>
        <div class="hints">
            <strong>ìƒ˜í”Œ ì£¼ì†Œ:</strong>
            <span onclick="fillAddress('ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 152')">ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 152</span>
            <span onclick="fillAddress('ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ ì„¸ì¢…ëŒ€ë¡œ 209')">ì¢…ë¡œêµ¬ ì„¸ì¢…ëŒ€ë¡œ 209</span>
            <span onclick="fillAddress('ì„œìš¸ì‹œ ë§ˆí¬êµ¬ ì–‘í™”ë¡œ 45')">ë§ˆí¬êµ¬ ì–‘í™”ë¡œ 45</span>
        </div>
    </section>

    <!-- ë¡œë”© í‘œì‹œ -->
    <div id="loading">ğŸ” ê²€ìƒ‰ ì¤‘...</div>

    <!-- ì˜¤ë¥˜ ë©”ì‹œì§€ -->
    <div id="error-msg"></div>

    <!-- ê²°ê³¼ ì„¹ì…˜ -->
    <section id="result-section">
        <!-- ê±´ì¶•ë¬¼ ê¸°ë³¸ ì •ë³´ -->
        <div class="card" id="building-card">
            <div class="section-title">ğŸ¢ ê±´ì¶•ë¬¼ ê¸°ë³¸ ì •ë³´</div>
            <div class="info-grid" id="building-info"></div>
        </div>

        <!-- íŒë‹¨ ê²°ê³¼ -->
        <div class="card" id="judgment-card">
            <div class="section-title">ğŸš° ì˜¥ë‚´ì†Œí™”ì „ ì„¤ì¹˜ ëŒ€ìƒ íŒë‹¨</div>
            <div id="judgment-result"></div>
        </div>
    </section>
</div>

<script>
    /* ===== ìƒ˜í”Œ ê±´ì¶•ë¬¼ ë°ì´í„° ===== */
    const SAMPLE_BUILDINGS = [
        {
            ì£¼ì†Œ: "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 152",
            ê±´ì¶•ë¬¼ëª…: "ê°•ë‚¨íŒŒì´ë‚¸ìŠ¤ì„¼í„°",
            ì—°ë©´ì : 5600,
            ì§€ìƒì¸µìˆ˜: 8,
            ì§€í•˜ì¸µìˆ˜: 2,
            ì£¼ìš©ë„: "ì—…ë¬´ì‹œì„¤",
            í—ˆê°€ì¼: "2019-03-15",
            ì‚¬ìš©ìŠ¹ì¸ì¼: "2020-08-22"
        },
        {
            ì£¼ì†Œ: "ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ ì„¸ì¢…ëŒ€ë¡œ 209",
            ê±´ì¶•ë¬¼ëª…: "ì„¸ì¢…ë¹Œë”©",
            ì—°ë©´ì : 2800,
            ì§€ìƒì¸µìˆ˜: 6,
            ì§€í•˜ì¸µìˆ˜: 1,
            ì£¼ìš©ë„: "ì—…ë¬´ì‹œì„¤",
            í—ˆê°€ì¼: "2010-05-20",
            ì‚¬ìš©ìŠ¹ì¸ì¼: "2011-03-10"
        },
        {
            ì£¼ì†Œ: "ì„œìš¸ì‹œ ë§ˆí¬êµ¬ ì–‘í™”ë¡œ 45",
            ê±´ì¶•ë¬¼ëª…: "ë§ˆí¬ì†Œí˜•ë¹Œë”©",
            ì—°ë©´ì : 800,
            ì§€ìƒì¸µìˆ˜: 3,
            ì§€í•˜ì¸µìˆ˜: 0,
            ì£¼ìš©ë„: "ì—…ë¬´ì‹œì„¤",
            í—ˆê°€ì¼: "2020-01-15",
            ì‚¬ìš©ìŠ¹ì¸ì¼: "2020-10-30"
        }
    ];

    /* API í‚¤ (í–¥í›„ ì‹¤ì œ API ì—°ë™ ì‹œ ì…ë ¥) */
    const API_KEY = kG9%2FhjP3xTsNQhqUD6WjLBvY2kAYzEQydlVgdOqiRoesa9Y8lfWmT%2B7%2Frp0YEcYHU3mtBPhMXttHYQukM8DU1g%3D%3D;

    /* ë²•ë ¹ ë°ì´í„° ìºì‹œ */
    let fireLawsData = null;

    /* ===== í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” ===== */
    window.onload = init;

    /**
     * ì´ˆê¸°í™”: ë²•ë ¹ ë°ì´í„° ë¡œë“œ ë° Enter í‚¤ ì´ë²¤íŠ¸ ë“±ë¡
     */
    function init() {
        loadFireLaws();

        // Enter í‚¤ë¡œ ê²€ìƒ‰ ì‹¤í–‰
        const input = document.getElementById('address-input');
        input.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                searchBuilding();
            }
        });
    }

    /**
     * fire-laws.json íŒŒì¼ì—ì„œ ë²•ë ¹ ë°ì´í„° ë¡œë“œ
     */
    async function loadFireLaws() {
        try {
            const response = await fetch('fire-laws.json');
            if (!response.ok) {
                throw new Error('ë²•ë ¹ ë°ì´í„° íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
            }
            fireLawsData = await response.json();
        } catch (err) {
            showError('âš ï¸ ë²•ë ¹ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + err.message);
        }
    }

    /**
     * ìƒ˜í”Œ ì£¼ì†Œ íŒíŠ¸ í´ë¦­ ì‹œ ì…ë ¥ë€ì— ì£¼ì†Œ ì±„ìš°ê¸°
     */
    function fillAddress(address) {
        document.getElementById('address-input').value = address;
        searchBuilding();
    }

    /**
     * ê±´ì¶•ë¬¼ ê²€ìƒ‰ ë©”ì¸ í•¨ìˆ˜
     */
    function searchBuilding() {
        const address = document.getElementById('address-input').value.trim();
        if (!address) {
            showError('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        // ì˜¤ë¥˜ ì´ˆê¸°í™” ë° ë¡œë”© í‘œì‹œ
        hideError();
        showLoading(true);
        hideResult();

        // ë²•ë ¹ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë‹¤ì‹œ ë¡œë“œ ì‹œë„
        if (!fireLawsData) {
            loadFireLaws().then(() => processSearch(address));
        } else {
            // ì‚´ì§ ë”œë ˆì´ë¡œ "ê²€ìƒ‰ ì¤‘" UX ì—°ì¶œ
            setTimeout(() => processSearch(address), 300);
        }
    }

    /**
     * ê²€ìƒ‰ ì²˜ë¦¬: ìƒ˜í”Œ ë°ì´í„°ì—ì„œ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ í›„ ê²°ê³¼ í‘œì‹œ
     */
    function processSearch(address) {
        // ìƒ˜í”Œ ë°ì´í„°ì—ì„œ ì£¼ì†Œ ê²€ìƒ‰ (ë¶€ë¶„ ì¼ì¹˜)
        let building = findSampleBuilding(address);
        let usedFallback = false;

        // ëª» ì°¾ìœ¼ë©´ ì²« ë²ˆì§¸ ìƒ˜í”Œë¡œ ëŒ€ì²´ (í…ŒìŠ¤íŠ¸ìš©)
        if (!building) {
            building = SAMPLE_BUILDINGS[0];
            usedFallback = true;
        }

        showLoading(false);

        if (!fireLawsData) {
            showError('ë²•ë ¹ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.');
            return;
        }

        // ì£¼ì†Œ ë¯¸ë°œê²¬ ì•ˆë‚´
        if (usedFallback) {
            showError('âš ï¸ ì…ë ¥í•œ ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ ìƒ˜í”Œ ë°ì´í„°(ê°•ë‚¨íŒŒì´ë‚¸ìŠ¤ì„¼í„°)ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.');
        }

        // ì ìš© ë²•ë ¹ ì°¾ê¸°
        const laws = fireLawsData['ì˜¥ë‚´ì†Œí™”ì „']['ì—°í˜'];
        const applicableLaw = findApplicableLaw(building.í—ˆê°€ì¼, laws);

        // ì„¤ì¹˜ ëŒ€ìƒ ì—¬ë¶€ íŒë‹¨
        const { isTarget, matchedCondition } = checkFireHydrant(building, applicableLaw);

        // ê²°ê³¼ í‘œì‹œ
        displayResult(building, isTarget, applicableLaw, matchedCondition);
    }

    /**
     * ìƒ˜í”Œ ë°ì´í„°ì—ì„œ ë¶€ë¶„ ì¼ì¹˜ ì£¼ì†Œ ê²€ìƒ‰
     * @param {string} address - ê²€ìƒ‰í•  ì£¼ì†Œ
     * @returns {object|null} ê±´ì¶•ë¬¼ ê°ì²´ ë˜ëŠ” null
     */
    function findSampleBuilding(address) {
        return SAMPLE_BUILDINGS.find(b =>
            b.ì£¼ì†Œ.includes(address) || address.includes(b.ì£¼ì†Œ)
        ) || null;
    }

    /**
     * í—ˆê°€ì¼ì— í•´ë‹¹í•˜ëŠ” ë²•ë ¹ ì°¾ê¸°
     * @param {string} permitDateStr - í—ˆê°€ì¼ (YYYY-MM-DD)
     * @param {Array} laws - ë²•ë ¹ ì—°í˜ ë°°ì—´
     * @returns {object|null} ì ìš© ë²•ë ¹ ê°ì²´ ë˜ëŠ” null
     */
    function findApplicableLaw(permitDateStr, laws) {
        const permitDate = new Date(permitDateStr);

        for (const law of laws) {
            const start = new Date(law['ì‹œí–‰ì¼']);
            // ì¢…ë£Œì¼ì´ nullì´ë©´ í˜„ì¬ê¹Œì§€ ì ìš©
            const end = law['ì¢…ë£Œì¼'] ? new Date(law['ì¢…ë£Œì¼']) : new Date('9999-12-31');

            if (permitDate >= start && permitDate <= end) {
                return law;
            }
        }
        return null;
    }

    /**
     * ì˜¥ë‚´ì†Œí™”ì „ ì„¤ì¹˜ ëŒ€ìƒ ì—¬ë¶€ íŒë‹¨
     * @param {object} building - ê±´ì¶•ë¬¼ ì •ë³´
     * @param {object|null} law - ì ìš© ë²•ë ¹
     * @returns {{ isTarget: boolean, matchedCondition: object|null }}
     */
    function checkFireHydrant(building, law) {
        if (!law) {
            return { isTarget: false, matchedCondition: null };
        }

        for (const condition of law['ì¡°ê±´']) {
            // 1. ìš©ë„ ì¼ì¹˜ í™•ì¸
            if (condition['ìš©ë„'] !== building.ì£¼ìš©ë„) {
                continue;
            }

            // 2. ì—°ë©´ì  ì¡°ê±´ í™•ì¸ (ì¡°ê±´ ì—†ìœ¼ë©´ falseë¡œ ì²˜ë¦¬)
            const areaOk = condition['ì—°ë©´ì _ì´ìƒ'] !== null
                ? building.ì—°ë©´ì  >= condition['ì—°ë©´ì _ì´ìƒ']
                : false;

            // 3. ì¸µìˆ˜ ì¡°ê±´ í™•ì¸ (ì¡°ê±´ ì—†ìœ¼ë©´ falseë¡œ ì²˜ë¦¬)
            const floorOk = condition['ì¸µìˆ˜_ì´ìƒ'] !== null
                ? building.ì§€ìƒì¸µìˆ˜ >= condition['ì¸µìˆ˜_ì´ìƒ']
                : false;

            // 4. í•˜ë‚˜ ì´ìƒì˜ ì¡°ê±´ ë§Œì¡± ì‹œ ì„¤ì¹˜ ëŒ€ìƒ
            if (areaOk || floorOk) {
                return { isTarget: true, matchedCondition: condition };
            }
        }

        return { isTarget: false, matchedCondition: null };
    }

    /**
     * ê²°ê³¼ í™”ë©´ì— í‘œì‹œ
     */
    function displayResult(building, isTarget, law, matchedCondition) {
        // ê±´ì¶•ë¬¼ ê¸°ë³¸ ì •ë³´ í‘œì‹œ
        const infoGrid = document.getElementById('building-info');
        infoGrid.innerHTML = `
            <div class="info-item">
                <div class="label">ğŸ¢ ê±´ì¶•ë¬¼ëª…</div>
                <div class="value">${escapeHtml(building.ê±´ì¶•ë¬¼ëª…)}</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ“ ì£¼ì†Œ</div>
                <div class="value">${escapeHtml(building.ì£¼ì†Œ)}</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ“ ì—°ë©´ì </div>
                <div class="value">${building.ì—°ë©´ì .toLocaleString()} ã¡</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ—ï¸ ì¸µìˆ˜</div>
                <div class="value">ì§€ìƒ ${building.ì§€ìƒì¸µìˆ˜}ì¸µ / ì§€í•˜ ${building.ì§€í•˜ì¸µìˆ˜}ì¸µ</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ›ï¸ ì£¼ìš©ë„</div>
                <div class="value">${escapeHtml(building.ì£¼ìš©ë„)}</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ“… í—ˆê°€ì¼</div>
                <div class="value">${escapeHtml(building.í—ˆê°€ì¼)}</div>
            </div>
            <div class="info-item">
                <div class="label">ğŸ“… ì‚¬ìš©ìŠ¹ì¸ì¼</div>
                <div class="value">${escapeHtml(building.ì‚¬ìš©ìŠ¹ì¸ì¼)}</div>
            </div>
        `;

        // íŒë‹¨ ê²°ê³¼ í‘œì‹œ
        const judgmentDiv = document.getElementById('judgment-result');

        if (!law) {
            judgmentDiv.innerHTML = `
                <div class="result-badge non-target">âš ï¸ í•´ë‹¹ í—ˆê°€ì¼ì— ì ìš©ë˜ëŠ” ë²•ë ¹ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            `;
        } else if (isTarget) {
            judgmentDiv.innerHTML = `
                <div class="result-badge target">âœ… ì„¤ì¹˜ ëŒ€ìƒ</div>
                <div class="law-detail">
                    <p>
                        <span class="law-label">ğŸ“‹ ì ìš© ë²•ë ¹</span><br>
                        <span class="law-value">${escapeHtml(law['ë²•ë ¹ëª…'])}</span>
                    </p>
                    <p>
                        <span class="law-label">ğŸ“… ì‹œí–‰ì¼</span>
                        <span class="law-value">${escapeHtml(law['ì‹œí–‰ì¼'])}</span>
                        &nbsp;~&nbsp;
                        <span class="law-value">${law['ì¢…ë£Œì¼'] ? escapeHtml(law['ì¢…ë£Œì¼']) : 'í˜„ì¬'}</span>
                    </p>
                    ${matchedCondition ? `
                    <p>
                        <span class="law-label">ğŸ“ ì„¤ì¹˜ ê¸°ì¤€</span><br>
                        <span class="law-value">${escapeHtml(matchedCondition['ì„¤ì¹˜ê¸°ì¤€'])}</span>
                    </p>
                    <p>
                        <span class="law-label">ğŸ’¡ ìƒì„¸ ì„¤ëª…</span><br>
                        <span class="law-value">
                            ê±´ì¶•ë¬¼ ìš©ë„ <strong>${escapeHtml(building.ì£¼ìš©ë„)}</strong>,
                            ì—°ë©´ì  <strong>${building.ì—°ë©´ì .toLocaleString()} ã¡</strong>ë¡œ
                            ê¸°ì¤€ (<strong>${matchedCondition['ì—°ë©´ì _ì´ìƒ'].toLocaleString()} ã¡ ì´ìƒ</strong>)ì„ ì¶©ì¡±í•©ë‹ˆë‹¤.
                        </span>
                    </p>
                    ` : ''}
                </div>
            `;
        } else {
            judgmentDiv.innerHTML = `
                <div class="result-badge non-target">âšª ë¹„ëŒ€ìƒ</div>
                <div class="law-detail">
                    <p>
                        <span class="law-label">ğŸ“‹ ì ìš© ë²•ë ¹</span><br>
                        <span class="law-value">${escapeHtml(law['ë²•ë ¹ëª…'])}</span>
                    </p>
                    <p>
                        <span class="law-label">ğŸ“… ì‹œí–‰ì¼</span>
                        <span class="law-value">${escapeHtml(law['ì‹œí–‰ì¼'])}</span>
                        &nbsp;~&nbsp;
                        <span class="law-value">${law['ì¢…ë£Œì¼'] ? escapeHtml(law['ì¢…ë£Œì¼']) : 'í˜„ì¬'}</span>
                    </p>
                    <p>
                        <span class="law-label">ğŸ’¡ ìƒì„¸ ì„¤ëª…</span><br>
                        <span class="law-value">
                            ê±´ì¶•ë¬¼ ìš©ë„ <strong>${escapeHtml(building.ì£¼ìš©ë„)}</strong>,
                            ì—°ë©´ì  <strong>${building.ì—°ë©´ì .toLocaleString()} ã¡</strong>ë¡œ
                            ì„¤ì¹˜ ëŒ€ìƒ ê¸°ì¤€ì— í•´ë‹¹í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                        </span>
                    </p>
                </div>
            `;
        }

        // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
        document.getElementById('result-section').style.display = 'block';
    }

    /* ===== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ===== */

    /**
     * ë¡œë”© í‘œì‹œ/ìˆ¨ê¸°ê¸°
     */
    function showLoading(visible) {
        document.getElementById('loading').style.display = visible ? 'block' : 'none';
    }

    /**
     * ê²°ê³¼ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
     */
    function hideResult() {
        document.getElementById('result-section').style.display = 'none';
    }

    /**
     * ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
     */
    function showError(msg) {
        const el = document.getElementById('error-msg');
        el.textContent = msg;
        el.style.display = 'block';
    }

    /**
     * ì˜¤ë¥˜ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
     */
    function hideError() {
        const el = document.getElementById('error-msg');
        el.style.display = 'none';
    }

    /**
     * XSS ë°©ì§€ìš© HTML ì´ìŠ¤ì¼€ì´í”„
     */
    function escapeHtml(str) {
        if (str === null || str === undefined) return '';
        return String(str)
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
    }
</script>
</body>
</html>
